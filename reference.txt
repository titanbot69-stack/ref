<script>
  document.addEventListener("DOMContentLoaded", function() {
    const buttons = document.querySelectorAll(".btn-outline-primary");
    const tableBody = document.getElementById("application-access-table-body");

    buttons.forEach(button => {
      button.addEventListener("click", function() {
        const appName = this.querySelector("img").alt.toLowerCase();

        fetch(`/get-application-data?app=${appName}`)
          .then(response => response.json())
          .then(data => {
            tableBody.innerHTML = "";
            data.forEach(employee => {
              const row = document.createElement("tr");
              row.innerHTML = `
                <td>${employee.emp_code}</td>
                <td>${employee.first_name} ${employee.last_name}</td>
                <td>${employee.business_email}</td>
              `;
              tableBody.appendChild(row);
            });
          })
          .catch(error => console.error("Error fetching application data:", error));
      });
    });
  });
</script>
